<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Form</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/all.css"
    integrity="sha384-hWVjflwFxL6sNzntih27bfxkr27PmbbK/iSvJ+a4+0owXq79v+lsFkW54bOGbiDQ" crossorigin="anonymous" />
  <link rel="stylesheet" type="text/css" href="css/style.css" />
  <link rel="stylesheet" type="text/css" href="css/form.css" />
</head>

<body>
  <div class="wrapper">
    <div>
      <nav>
        <div class="top-nav">
          <div class="brand-name">
            <img src="content/grupaVERSO-logo.webp" alt="grupaverso" />
          </div>
        </div>
      </nav>
      <div class="verso-close" onClick="formClose()">
        <div class="container">
          <div class="background"></div>
          <div class="part-1"></div>
          <div class="part-2"></div>
        </div>
      </div>
      <div class="form-wrapper">
        <div class="form-circle"></div>
        <form method="POST" action="send" id="form">
          <div>
            <label>
              Imię i nazwisko:
            </label></br>
            <input type="text" name="name" id="name">
          </div>
          <div>
            <label>
              Numer kontaktowy:
            </label></br>
            <input type="text" inputmode="numeric" pattern="[0-9]*" name="number" id="number">
          </div>
          <div>
            <label>
              Adres email:
            </label></br>
            <input type="text" name="email" id="email">
          </div>
          <div>
            <label>
              Twoja wiadomość:
            </label></br>
            <textarea type="textarea" rows="2" name="message" id="message" ></textarea>
          </div>
          <div class="form-accept">
            <input type="radio" name="radio" id="radio" checked="checked"/>
            <span class="checkmark"> </span>
            <p>
              Akceptuję warunki określone w zapisie dotyczącym prywatności.
            </p>
          </div>
          <div>
            <input class="form-btn" type="submit" name="submit" value="Wyślij" id="btn" />
          </div>
        </form>
      </div>
    </div>
  </div>
  <script src="form.js"></script>
  <script src="https://kit.fontawesome.com/55221ecb68.js" crossorigin="anonymous"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>


    $('form').on('submit', (e) => {
      e.preventDefault();

      //Pulling data to var (or const)
      var name = $('#name').val().trim();
      var number = $('#number').val().trim();
      var email = $('#email').val().trim();
      var text = $('#message').val().trim();

      //Container for data
      const data = {
        name,
        number,
        email,
        text
      };


      var nameCheck = $('#name').val();
      var numberCheck = $('#number').val();
      var emailCheck = $('#email').val();
      var textCheck = $('#message').val();
      var checkBox = document.getElementById("radio");

      if (emailCheck.length > 2 && emailCheck.includes('@') && emailCheck.includes('.')
        && checkBox.checked == true
        && numberCheck.length >= 9
        && textCheck.length > 0
        && nameCheck.length > 0) {

        //Sending data to Server
        $.post('/email', data, function () {
          console.log('SERVER RECEIVED OUR DATA');
        });
        //Email validation - Server
        $.ajax({
          url: "form.html",

          //Throw success
          success: function (data) {
            alert("Wiadomość została wysłana. Odpowiemy najszybciej jak to możliwe.");
            var delay = 1;
            setTimeout(function () { window.location = "index.html"; }, delay);
          },

          //Throw error
          error: function (XMLHttpRequest, textStatus, errorThrown) {
            if (XMLHttpRequest.status == 0) {
              alert("Błąd. Wiadomość nie została wysłana. Sprawdź swoje połączenie internetowe.");
            } else if (XMLHttpRequest.status == 404) {
              alert("Błąd. Wiadomość nie została wysłana.");
              var delay = 1;
              setTimeout(function () { window.location = "index.html"; }, delay);
            } else if (XMLHttpRequest.status == 500) {
              alert("Błąd. Wiadomość nie została wysłana.");
              var delay = 1;
              setTimeout(function () { window.location = "index.html"; }, delay);
            } else {
              alert('Błąd. Wiadomość nie została wysłana.\n' + XMLHttpRequest.responseText);
              var delay = 1;
              setTimeout(function () { window.location = "index.html"; }, delay);
            }
          }
        });
      }


      //All
      else if (emailCheck.length <= 2 && !emailCheck.includes('@') && !emailCheck.includes('.')
        && checkBox.checked == false
        && numberCheck.length < 9
        && textCheck.length == 0
        && nameCheck.length == 0) {
        alert("Prosimy, uzupełnij prawidłowo wszystkie pola.");
      }



      //Name and email
      else if (emailCheck.length <= 2 && !emailCheck.includes('@') && !emailCheck.includes('.')
        && nameCheck.length == 0) {
        alert("Prosimy, uzupełnij prawidłowo wszystkie pola.");
      }
      //Name and checker
      else if (checkBox.checked == false
        && nameCheck.length == 0) {
        alert("Prosimy, uzupełnij prawidłowo wszystkie pola.");
      }
      //Name and number
      else if (numberCheck.length < 9
        && nameCheck.length == 0) {
        alert("Prosimy, uzupełnij prawidłowo wszystkie pola.");
      }
      //Name and message
      else if (textCheck.length == 0
        && nameCheck.length == 0) {
        alert("Prosimy, uzupełnij prawidłowo wszystkie pola.");
      }
      //Name and number and mail
      else if (emailCheck.length <= 2 && !emailCheck.includes('@') && !emailCheck.includes('.')
        && numberCheck.length < 9
        && nameCheck.length == 0) {
        alert("Prosimy, uzupełnij prawidłowo wszystkie pola.");
      }
      //Name and number and message
      else if (numberCheck.length < 9
        && textCheck.length == 0
        && nameCheck.length == 0) {
        alert("Prosimy, uzupełnij prawidłowo wszystkie pola.");
      }
      //Name and number and checker
      else if (checkBox.checked == false
        && numberCheck.length < 9
        && nameCheck.length == 0) {
        alert("Prosimy, uzupełnij prawidłowo wszystkie pola.");
      }
      //Name and mail and text
      else if (emailCheck.length <= 2 && !emailCheck.includes('@') && !emailCheck.includes('.')
        && textCheck.length == 0
        && nameCheck.length == 0) {
        alert("Prosimy, uzupełnij prawidłowo wszystkie pola.");
      }
      //Name and mail and checker
      else if (emailCheck.length <= 2 && !emailCheck.includes('@') && !emailCheck.includes('.')
        && checkBox.checked == false
        && nameCheck.length == 0) {
        alert("Prosimy, uzupełnij prawidłowo wszystkie pola.");
      }
      //Name and text and checker
      else if (checkBox.checked == false
        && textCheck.length == 0
        && nameCheck.length == 0) {
        alert("Prosimy, uzupełnij prawidłowo wszystkie pola.");
      }
      //Name and number and mail and text
      else if (emailCheck.length <= 2 && !emailCheck.includes('@') && !emailCheck.includes('.')
        && numberCheck.length < 9
        && textCheck.length == 0
        && nameCheck.length == 0) {
        alert("Prosimy, uzupełnij prawidłowo wszystkie pola.");
      }
      //Name and number and mail and checker
      else if (emailCheck.length <= 2 && !emailCheck.includes('@') && !emailCheck.includes('.')
        && checkBox.checked == false
        && numberCheck.length < 9
        && nameCheck.length == 0) {
        alert("Prosimy, uzupełnij prawidłowo wszystkie pola.");
      }
      else if (checkBox.checked == false
        && numberCheck.length < 9
        && textCheck.length == 0
        && nameCheck.length == 0) {
        alert("Prosimy, uzupełnij prawidłowo wszystkie pola.");
      }

      else if (emailCheck.length <= 2 && !emailCheck.includes('@') && !emailCheck.includes('.')
        && checkBox.checked == false
        && textCheck.length == 0
        && nameCheck.length == 0) {
        alert("Prosimy, uzupełnij prawidłowo wszystkie pola.");
      }



      //Mail and checker
      else if (emailCheck.length <= 2 && !emailCheck.includes('@') && !emailCheck.includes('.')
        && checkBox.checked == false) {
        alert("Prosimy, uzupełnij prawidłowo wszystkie pola.");
      }
      //Mail and number
      else if (emailCheck.length <= 2 && !emailCheck.includes('@') && !emailCheck.includes('.')
        && numberCheck.length < 9) {
        alert("Prosimy, uzupełnij prawidłowo wszystkie pola.");
      }
      //Mail and message
      else if (emailCheck.length <= 2 && !emailCheck.includes('@') && !emailCheck.includes('.')
        && textCheck.length == 0) {
        alert("Prosimy, uzupełnij prawidłowo wszystkie pola.");
      }
      //Checker and number
      else if (checkBox.checked == false
        && numberCheck.length < 9
      ) {
        alert("Prosimy, uzupełnij prawidłowo wszystkie pola.");
      }
      //Checker and message
      else if (checkBox.checked == false
        && textCheck.length == 0) {
        alert("Prosimy, uzupełnij prawidłowo wszystkie pola.");
      }
      //Number and message
      else if (numberCheck.length < 9
        && textCheck.length == 0) {
        alert("Prosimy, uzupełnij prawidłowo wszystkie pola.");
      }



      //Mail and number and message
      else if (emailCheck.length <= 2 && !emailCheck.includes('@') && !emailCheck.includes('.')
        && numberCheck.length < 9
        && textCheck.length == 0) {
        alert("Prosimy, uzupełnij prawidłowo wszystkie pola.");
      }
      //Mail and checker and message
      else if (emailCheck.length <= 2 && !emailCheck.includes('@') && !emailCheck.includes('.')
        && checkBox.checked == false
        && textCheck.length == 0) {
        alert("Prosimy, uzupełnij prawidłowo wszystkie pola.");
      }
      //Mail and number and checker
      else if (emailCheck.length <= 2 && !emailCheck.includes('@') && !emailCheck.includes('.')
        && checkBox.checked == false
        && numberCheck.length < 9) {
        alert("Prosimy, uzupełnij prawidłowo wszystkie pola.");
      }
      //Checker and number and message
      else if (checkBox.checked == false
        && numberCheck.length < 9
        && textCheck.length == 0) {
        alert("Prosimy, uzupełnij prawidłowo wszystkie pola.");
      }


      //Name
      else if (nameCheck.length == 0) {
        alert("Podaj swoje imię i nazwisko.");
      }
      //Email
      else if (emailCheck.length <= 2 && !emailCheck.includes('@') && !emailCheck.includes('.')) {
        alert("Podany adres email nie jest poprawny.");
      }
      //Checker
      else if (checkBox.checked == false) {
        alert("Musisz zaakceptować warunki przed wysłaniem zgłoszenia.");
      }
      //Number
      else if (numberCheck.length < 9) {
        alert("Upewnij się, że podany numer telefonu jest prawidłowy.");
      }
      //Message
      else if (textCheck.length == 0) {
        alert("Uzupełnij wiadomość.");
      }

    });;

    $(document).ready(function () {
      $(document).on('mouseenter', '.divbutton', function () {
        $(this).find(":button").show();
      }).on('mouseleave', '.divbutton', function () {
        $(this).find(":button").hide();
      }).on('click', ':button', function () {
        $(this).parent().remove();
      });
    });
  </script>
</body>

</html>